!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("fs"),require("@angular/core"),require("@angular/compiler"),require("@angular/platform-server"),require("@nguniversal/express-engine/tokens")):"function"==typeof define&&define.amd?define("@nguniversal/express-engine",["exports","fs","@angular/core","@angular/compiler","@angular/platform-server","@nguniversal/express-engine/tokens"],r):r((e.nguniversal=e.nguniversal||{},e.nguniversal.expressEngine={}),e.fs,e.ng.core,e.ng.compiler,e.ng.platformServer,e.nguniversal.expressEngine.tokens)}(this,function(e,r,n,o,t,i){"use strict";
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */var u=function(){function e(){}return e.prototype.get=function(e){return new Promise(function(n,o){r.readFile(e,function(e,r){if(e)return o(e);n(r.toString())})})},e}(),s={},a=new Map;
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
e.ngExpressEngine=function c(e){var c=t.platformDynamicServer().injector.get(n.CompilerFactory).createCompiler([{providers:[{provide:o.ResourceLoader,useClass:u,deps:[]}]}]);return function(o,u,l){u.providers=u.providers||[];try{var p=u.bootstrap||e.bootstrap;if(!p)throw new Error("You must pass in a NgModule or NgModuleFactory to be bootstrapped");e.providers=e.providers||[];var f=u.req,d=e.providers.concat(u.providers,function g(e,r){var n=[{provide:i.REQUEST,useValue:e}];return r&&n.push({provide:i.RESPONSE,useValue:r}),n}(u.req,u.res),[{provide:t.INITIAL_CONFIG,useValue:{document:u.document||function v(e){return s[e]=s[e]||r.readFileSync(e).toString()}(o),url:u.url||f.protocol+"://"+(f.get("host")||"")+f.originalUrl}}]);(function m(e,r){return new Promise(function(o,t){if(e instanceof n.NgModuleFactory)o(e);else{var i=a.get(e);i?o(i):r.compileModuleAsync(e).then(function(r){a.set(e,r),o(r)},function(e){t(e)})}})})(p,c).then(function(e){return t.renderModuleFactory(e,{extraProviders:d})}).then(function(e){l(null,e)},function(e){l(e)})}catch(e){l(e)}}},Object.defineProperty(e,"__esModule",{value:!0})});